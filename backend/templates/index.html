<!DOCTYPE html>
<html>

<head>
  <link rel="icon" href="data:,">

    <style type="text/css">

    /*final msg*/
       h1.final-msg{
      font-size: xx-large;
      font-weight: bolder;
      color: #525151;
    }    
    h2.final-msg{
      font-size: large;
      font-weight: 500;
      color: #525151;
    }
    h3.final-msg{
      background: #dcdce4;
      padding: 60px;
      font-family: monospace;
      color: black;
    }
    .final-msg a{
      color: #840707;
      font-weight: 900;
      font-size: xx-large;
    }
    /*end of final msg */
   
button {
  width: 12em;
  height: 3em;
  margin: 10px;
    cursor: pointer;
}

html{
 background: #4d4d4d;
}

body{
  margin: 0 auto;
  max-height: 430px;
  max-width: 700px;
  height: 430px;
  padding: 50px 90px 50px 90px;
  border-top: solid #FE6F00 40px;
  background: #fff;
  color: #303030;
  text-align: center;
  margin-top: 80px;
  margin-bottom: 40px;
  font-family: sans-serif;
  box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
  border-radius: 15px;
  position: relative;
  overflow: hidden;
}

#content{
  margin: 0 auto;
    top: 0%;
    left: 50%;
    text-align: left;
    font-size:larger;
    font-weight: 600;
    color: #4D4D4D;
}

#next-btn{
    margin-right: -90px;
    margin-top: 0px;
    color: #EFF0EF;
    background: #FE6F00;
    cursor: pointer;
    border-radius: 200em 0 0 200em;
    width: 62px;
    height: 89px;
    font-size: 43px;
    font-family: monospace;
    text-transform: uppercase;
    font-weight: bold;
    transition-duration: 0.4s;
    overflow: hidden;
    text-align: center;
    float: right;
    position: absolute;
    right: 90px;
    top: 150px;
}
#next-btn:hover {
    color:white;
    transform: scale(1.1);
    cursor: pointer;
}
#next-btn[disabled]{
  color: white;
     background-color: grey;
}
#next-btn[disabled]:hover {
    color: white;
     background-color: grey;
    transform: scale(1.0);
}

#previous-btn{
   left: -10px;
    border-radius: 0 200em 200em 0;
    height: 89px;
    overflow: hidden;
    position: relative;
        margin-top: 0px;
    color: #EFF0EF;
    background: #FE6F00;
    cursor: pointer;
    width: 62px;
     font-size: 43px;
    font-family: monospace;
    text-transform: uppercase;
    font-weight: bold;
    transition-duration: 0.4s;
     text-align: center;
    float: left;
    position: absolute;
    
    top: 150px;

}
#previous-btn:hover {
   color:white;
    transform: scale(1.1);
    cursor: pointer;
}
#previous-btn[disabled]{
  color: white;
     background-color: grey;
}
#previous-btn[disabled]:hover {
    color: white;
    background-color: grey;
    transform: scale(1.0);
}

.label--checkbox,
.label--radio {
  display: block;
  position: relative;
  margin: .5rem;
  font-family: sans-serif;
  line-height: 135%;
  cursor: pointer;
  text-align:left;
  font-size:medium;
  font-weight: lighter;
  color: #4D4D4D;
}

#goto-survey-btn, #start-btn{
  margin-top:60px;
  color: #EFF0EF;
    background: #FE6F00;
    cursor: pointer;
    border-radius: 50px;
    width: 222px;
    font-size: x-large;
    font-family: monospace;
    text-transform: uppercase;
    font-weight: bold;
}

#save-btn {
    color: #EFF0EF;
    background: #FE6F00;
    cursor: pointer;
    border-radius: 50px;
    width: 222px;
    font-size: x-large;
    font-family: monospace;
    text-transform: uppercase;
    font-weight: bold;
    height: 45px;
    position: absolute;
    left: 60px;
    top: 400px;
}
#save-btn[disabled] {
  background: grey;
}

div#content label:first-child {
    margin-top: 38px;
}


/*checkbox and radio btn*/

.checkbox {
  position: relative;
  top: -0.375rem;
  margin: 0 1rem 0 0;
  cursor: pointer;
}
.checkbox:before {
  -webkit-transition: -webkit-transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  -moz-transition: -moz-transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  transition: transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  -webkit-transform: rotate(-45deg) scale(0, 0);
  -moz-transform: rotate(-45deg) scale(0, 0);
  -ms-transform: rotate(-45deg) scale(0, 0);
  -o-transform: rotate(-45deg) scale(0, 0);
  transform: rotate(-45deg) scale(0, 0);
  content: "";
  position: absolute;
  left: 0.1875rem;
  top: 0.125rem;
  z-index: 1;
  width: 0.75rem;
  height: 0.375rem;
  border: 2px solid #16a085;
  border-top-style: none;
  border-right-style: none;
}
.checkbox:checked:before {
  -webkit-transform: rotate(-45deg) scale(1, 1);
  -moz-transform: rotate(-45deg) scale(1, 1);
  -ms-transform: rotate(-45deg) scale(1, 1);
  -o-transform: rotate(-45deg) scale(1, 1);
  transform: rotate(-45deg) scale(1, 1);
}
.checkbox:after {
  content: "";
  position: absolute;
  top: -0.125rem;
  left: 0;
  width: 1rem;
  height: 1rem;
  background: #fff;
  border: 2px solid #f2f2f2;
  cursor: pointer;
}

.radio {
  position: relative;
  margin: 0 1rem 0 0;
  cursor: pointer;
}
.radio:before {
  -webkit-transition: -webkit-transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  -moz-transition: -moz-transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  transition: transform 0.4s cubic-bezier(0.45, 1.8, 0.5, 0.75);
  -webkit-transform: scale(0, 0);
  -moz-transform: scale(0, 0);
  -ms-transform: scale(0, 0);
  -o-transform: scale(0, 0);
  transform: scale(0, 0);
  content: "";
  position: absolute;
  top: 0;
  left: 0.125rem;
  z-index: 1;
  width: 0.75rem;
  height: 0.75rem;
  background: #16a085;
  border-radius: 50%;
}
.radio:checked:before {
  -webkit-transform: scale(1, 1);
  -moz-transform: scale(1, 1);
  -ms-transform: scale(1, 1);
  -o-transform: scale(1, 1);
  transform: scale(1, 1);
}
.radio:after {
  content: "";
  position: absolute;
  top: -0.25rem;
  left: -0.125rem;
  width: 1rem;
  height: 1rem;
  background: #fff;
  border: 2px solid #f2f2f2;
  border-radius: 50%;
}

input[type=text] {
    width: 50%;
    padding: 12px 20px;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}
#answer{
  margin-top:38px;
}
#subAnswer {
  margin-top:4px;
}



    .formated-text {
        width: 100%;
        display: inline-block;
        font-family: sans serif;
    }

    </style>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript">
    // ========= To define global variables =====================
    {% if history %}
    var globalHistory = {{ history | safe }};
    var globalSession = {{ session }}; {%
        else %} {% endif %}
    const API_BASE = "http://51.75.249.213:5000";

    const QUESTION_TYPE = {
        SINGLE_CHOICE: 0,
        MULTI_CHOICE: 1,
        CONTROL_QUESTION: 2,
        TEXT: 3,
        MIXED: 4,
        NO_CHOICE: 5
    }

    const TOPICS = {
        YOUR_COMPANY: "Your Company",
        INFRASTRUCTURES_SUB: [
            "Information System",
            "Server/Computer Room",
            "Server / A cupboard or a dedicated room",
            "Workstation"
        ],
        INFRASTRUCTURES: "Infrastructures",
        MANAGEMENT: "Management",
        ENERGY: "Energy Consumption",
        PRINTING: "Printing",
        PRINTING_SUB: "Consumables"
    }

    const DEPARTMENTS = {
        ORG: "Your organization",
        ITS: "IT/Servers",
        ITW: "IT/Workstations",
        GIT: "Green IT",
        ENERGY: "Energy consumption",
        PRINTING: "Printing and paper",
        // "IT Services", "Management", "Facility Management"
    };

    var appState = {
        currQst: 0,
        history: {}, // TODO: load when an existing survey is load
        stepTracking: [],
        sessionId: "0",
        selectedDepartment: ""
    };

    const QUESTION_MAP = {
        // Topic: Your Company
        1: {
            // ind: 1,
            q: "In which sector of activity is your company active? (linked with your APE code)",
            a: [
                "Industry",
                "Business",
                "Information and communication",
                "Other services activity",
                "All other activities (financial, agricultural activities ...)",
                "Construction",
                "Public sector",
                "Specialized, Scientific and Technical or Administrative and Support Services Activities",
                "Real estate"
            ],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        2: {
            // ind: 2,
            q: "What is the number of employees in your company on 18/12/31 ?",
            a: ["0", "1 to 2", "3 to 9", "10 to 49", "50 to 249", "250 to 4999", "More than 5000"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        3: {
            // ind: 3,
            q: "What is the turnover of your company in the last fiscal year? (or annual budget for Public sector)",
            a: ["0 to 100K €", "100 to 500 K€", "500 to 2 M €", "2 to 10 M€", "10 to 50 M€", "More than 50 M€"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        4: {
            // ind: 4,
            q: "Do you develop digital services for internal or external use (sales to customers)?",
            a: ["Yes", "No"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        5: {
            // ind: 5,
            q: "What is the number of users of your digital services?",
            a: [],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.TEXT
        },
        6: {
            // ind: 6,
            q: "Do you apply the rules and best practices for digital accessibility?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        7: {
            // ind: 7,
            q: "Have you optimized the states and printouts in your application tools (reduced number of pages when printing, ink consumption ...)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        8: {
            //ind: 8,
            q: "Do you integrate the principles of the ecodesign of digital services?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        9: {
            // ind: 9,
            q: "Do you use a modular application architecture?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        10: {
            //  ind: 10,
            q: "Do you do a design review at the end of your application's development?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.YOUR_COMPANY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // Topic INFRASTRUCTURES --> Information Technology
        11: {
            //  ind: 11,
            q: "What is the overall storage volume of your corporate data (centralized on external hard drives, centralized server, NAS, SAN ...) in Terabytes (TB) useful?",
            a: ["I don't know", "I do not want to answer", "x TB"], // >> response field to be added,
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[0],
            qType: QUESTION_TYPE.MIXED
        },
        12: {
            //   ind: 12,
            q: "Do you have a server or do you only work with one or more workstations?",
            a: ["We work with workstation (s), without centralized physical server", "We have (at least) a centralized physical server"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[0],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        13: {
            //   ind: 13,
            q: "Do you have a dedicated room, simple room or cupboard with bay dedicated to your IT infrastructure?",
            a: ["A closet or a room without any specific system", "A dedicated room"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[0],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // Topic INFRASTRUCTURES --> Server/Computer Room
        14: {
            //  ind: 14,
            q: "Is your computer room in house or at a host?",
            a: ["Internal", "Host Member of the European Code of Conduct for Datacenters", "Non-adhering Host of the European Code of Conduct for Data Centers"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        15: {
            // ind: 15,
            q: "What is the total area of your computer rooms (excluding technical infrastructure *)? (in m2)",
            a: [
                "X m2", //>> response field to be added
                "I don't know",
                "I do not want to answer"
            ],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.MIXED
        },
        16: {
            //ind: 16,
            q: "Do you know the PUE * of your Data Center?",
            a: ["*PUE : Power Usage Effectiveness", "Less than 1,6 ", "Between 1,6 and 2,1 ", "More than 2,1 ", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        17: {
            //ind: 17,
            q: "What is the rate of charge or energy use of your computer rooms?",
            a: [
                "Rate = Electrical power absorbed by your IT equipment, divided by room capacity in kW, then multiplied by 100 (used energy / available energy)",
                "100% - 90% ",
                "90% - 60% ",
                "Less than 60% ",
                "I don't know"
            ],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        18: {
            //ind: 18,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially :",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.NO_CHOICE
        },
        19: {
            //ind: 19,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t The purchase of non-IT equipment from IT rooms (air conditioning, air treatment, inverters, etc.)" +
                "\t according to energy efficiency criteria",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        20: {
            //ind: 20,
            q: 'Have you led or are you planning actions to optimize your infrastructure? Especially:\n' +
                '\t Implementing the good practices of the "European Code of Conduct for DataCenter"?',
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        21: {
            //ind: 21,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Data center PUE tracking",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        22: {
            //ind: 22,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Regular monitoring of environmental indicators of computer rooms",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        23: {
            //ind: 23,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Environmental impact analysis of the datacenter in life cycle approach",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        24: {
            //ind: 24,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Optimizing the architecture and layout of rooms",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        25: {
            //ind: 25,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t The urbanization of halls in hot / cold aisles",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        26: {
            //ind: 26,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Containment of air flows (corridors)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        27: {
            //ind: 27,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t The use of natural cooling sources (freecooling)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        28: {
            //ind: 28,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t Implementation of a heat recovery system for computer rooms (heating)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        29: {
            //ind: 29,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t The set temperature in the cold corridor remains higher than 24 °",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        30: {
            //ind: 30,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially:\n" +
                "\t The choice of a modular datacenter architecture",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[1],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },

        // Topic INFRASTRUCTURES --> Server / A cupboard or a dedicated room
        31: {
            //ind: 31,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially :",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.NO_CHOICE
        },
        32: {
            //ind: 32,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tSuspending network equipment",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        33: {
            //ind: 33,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tPooling physical equipment",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        34: {
            //ind: 34,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tUninstalling unnecessary infrastructure",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        35: {
            //ind: 35,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tTraceability of material elements (CMDB)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        36: {
            //ind: 36,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tThe correct sizing of the servers in relation to their use",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        37: {
            //ind: 37,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tGive priority to ASHRAE 2 compatible equipment",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        38: {
            //ind: 38,
            q: "Have you led or are you planning actions to optimize your infrastructure? Especially: \n" +
                "\tA procedure for provisioning and de-provisioning data-processing equipment in datacenters",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        39: {
            //ind: 39,
            q: "Do you know the number of physical servers and virtual servers in your company?",
            a: ["No", "I do not want to answer", "Yes"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        40: {
            //ind: 40,
            q: "How many physical servers do you have?",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.TEXT
        },
        41: {
            //ind: 41,
            q: "How many virtual servers do you have?",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.TEXT
        },
        42: {
            //ind: 42,
            q: "What will be the evolution of your number of physical servers for 2019? (in% or quantity)",
            a: [
                "In %", //>> response field to be added
                "In quantity", // >> response field to be added
                "I do not want to answer",
                "I don't know"
            ],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.MIXED
        },
        43: {
            //ind: 43,
            q: "What will be the evolution of your number of virtual servers for 2019? (in% or quantity)",
            a: [
                "In %", //>> response field to be added
                "In quantity", // >> response field to be added
                "I do not want to answer",
                "I don't know"
            ],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[2],
            qType: QUESTION_TYPE.MIXED
        },
        // Topic: Management
        44: {
            //ind: 44,
            q: "Has your company appointed a Green IT Manager / Digital Manager?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        45: {
            //ind: 45,
            q: "Do you have a responsible digital strategy broken down into an action plan?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        46: {
            //ind: 46,
            q: "Is Green IT a topic integrated into your CSR strategy?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        47: {
            //ind: 47,
            q: "Do you regularly evaluate the environmental impacts of your information system?",
            a: [
                "Yes partially, including only equipment present in the company",
                "Yes totally, including our internal equipment and services hosted by third parties",
                "No",
                "I do not know"
            ],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        48: {
            //ind: 48,
            q: "Do you have a team of competent referees on the topics of Green IT?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        49: {
            //ind: 49,
            q: "Have you integrated Green IT into your business strategy",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.MANAGEMENT,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // Topic: Infrastructure --> Workstation
        50: {
            //ind: 50,
            q: "Do you have those equipments in your company:|" +
                "Used: equipment used in the business activity \n" +
                "Not used functional: equipment in working order but no more used by the company (stored) \n" +
                "Neither used nor functional: out of service equipment (HS) waiting for end of life treatment",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.NO_CHOICE
        },
        51: {
            //ind: 51,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nFixed stations, workstations",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        52: {
            //ind: 52,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nLaptops, digital tablets",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        53: {
            //ind: 53,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nSmall printers (<15kg, potentially used by a household)",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        54: {
            //ind: 54,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nFlat screen monitors",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        55: {
            //ind: 55,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nOther flat screens (TV, projection screen, digital board ...)",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        56: {
            //ind: 56,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nCRT monitors (monitors or other)",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        57: {
            //ind: 57,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nVideo projectors",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        58: {
            //ind: 58,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nMobile phones",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        59: {
            //ind: 59,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nFixed telephones (standalone not connected to such a standard)",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        60: {
            //ind: 60,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nDigital cameras",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        61: {
            //ind: 61,
            q: "Do you have those equipments in your company:\n" +
               "\t- Used: equipment used in the business activity\n" +
               "\t- Not used functional: equipment in working order but no more used by the company (stored)\n" +
               "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment\n" +
               "\nHard Disk Devices, Storage, Backup",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        62: {
            //ind: 62,
            q: "Do you have other devices in your company?\n" +
                "\t Keyboards, mouse, graphic tablets, scanners, microphones, speakers, office equipment ...",
            a: ["Yes", "No"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        63: {
            //ind: 63,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment",
            a: [],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.NO_CHOICE
        },
        64: {
            //ind: 64,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nKeyboards",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        65: {
            //ind: 65,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nMouse",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        66: {
            //ind: 66,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nGraphic tablets",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        67: {
            //ind: 67,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nScanners",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        68: {
            //ind: 68,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nSpeakers",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        69: {
            //ind: 69,
            q: "Regarding other devices, do you have in your company:\n" +
                "\t- Used: equipment used in the business activity \n"+
                "\t- Not used functional: equipment in working order but no more used by the company (stored) \n"+
                "\t- Neither used nor functional: out of service equipment (HS) waiting for end of life treatment" +
                "\nOffice automation",
            a: ["Used", "Not used functional", "Neither used nor functional"],
            topic: TOPICS.INFRASTRUCTURES,
            subTopic: TOPICS.INFRASTRUCTURES_SUB[3],
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // Topic: Energy consumption
        70: {
            //ind: 70,
            q: "Do you know the consumption of your workstation in kWh per year?",
            a: [
                "Yes (please specify how much in kWh / year)", // >> response field to be added"
                "No"
            ],
            topic: TOPICS.ENERGY,
            qType: QUESTION_TYPE.MIXED
        },
        71: {
            //ind: 71,
            q: "Do you track the energy consumption of your compagny activities?",
            a: [
                "Yes",
                "No",
                "I don't know"
            ],
            topic: TOPICS.ENERGY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        72: {
            //ind: 72,
            q: "Do you know the share of IT and IT equipment in your company's total energy consumption?",
            a: [
                "Yes (please specify how much in %)", // >> response field to be added
                "No"
            ],
            topic: TOPICS.ENERGY,
            qType: QUESTION_TYPE.MIXED
        },
        73: {
            //ind: 73,
            q: "Have you set up a power management system? (automatic shutdown / shutdown of workstations)",
            a: [
                "Yes",
                "No",
                "I don't know"
            ],
            topic: TOPICS.ENERGY,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },

        // Topic: Printing
        74: {
            //ind: 74,
            q: "Do you use copiers from a repackaging industry (second-hand / second-hand)?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        75: {
            //ind: 75,
            q: "Do you consolidate individual printers to shared printers?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        76: {
            //ind: 76,
            q: "Have you set up an identification system on printers (to trigger printing)?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        77: {
            //ind: 77,
            q: "What is the average life of your professional copier / MFP *?|* MFP Multi Fonction Printer",
            a: [
                "I do not know",
                "Do not want to answer",
                "x years (please specify)" //" >> response fields "comment" to be added"
            ],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.MIXED
        },
        78: {
            //ind: 78,
            q: "Are your printers set by default in eco mode? Especially:\n",
            a: [],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.NO_CHOICE
        },
        79: {
            //ind: 79,
            q: "Are your printers set by default in eco mode? Especially:\n" +
                "\tEnergy saving (Automatic standby)",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        80: {
            //ind: 80,
            q: "Are your printers set by default in eco mode? Especially:\n" +
                "\tBlack and white by default",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        81: {
            //ind: 81,
            q: "Are your printers set by default in eco mode? Especially:\n" +
                "\tDefault duplex",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        82: {
            //ind: 82,
            q: "Are your printers set by default in eco mode? Especially:\n" +
                "\tDefault draft mode",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // Topic: Printing --> Consumables
        83: {
            //ind: 83,
            q: "What is the number of pages printed / day / employee? (A4 equivalent)",
            a: ["Less than 10", "From 10 to 20", "From 20 to 30", "More than 30", "I don't know"],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        // TODO: Render text for each answer choice
        // concat str using |
        84: {
            //ind: 84,
            q: "Can you specify the number of cartridges / toners:",
            a: [
                "Cartridges used a year", // >> response field to be added
                "Cartridges stored in the average business", // >> response field to be added
                "Toners used a year", // >> response fields to be added
                "Toners stored in the average business" //>> response field to be added
            ],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.TEXT
        },
        85: {
            //ind: 85,
            q: "Do you organize the separate collection of waste cartridges / toners?",
            a: [
                "Yes, to a repackaging industry",
                "Yes, towards a recycling channel (destruction)",
                "No no separate collection device is planned"
            ],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
        86: {
            //ind: 86,
            q: "Do you prefer the use of recycled paper?",
            a: [
                "Yes, our paper is made from virgin paste",
                "Yes, mixed paper",
                "Yes, 100% recycled",
                "I'm not paying attention"
            ],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.MULTI_CHOICE
        },
        87: {
            //ind: 87,
            q: "Do you choose certified paper?",
            a: [
                "Yes, FSC",
                "Yes, PEFC",
                "Yes, Blue Angel",
                "Yes, European Label",
                "Yes, other", // >> comment fields to add
                "I'm not paying attention"
            ],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.MULTI_CHOICE
        },
        88: {
            //ind: 88,
            q: "Do you organize the separate collection of waste paper for recycling?",
            a: ["Yes", "No", "I don't know"],
            topic: TOPICS.PRINTING,
            subTopic: TOPICS.PRINTING_SUB,
            qType: QUESTION_TYPE.SINGLE_CHOICE
        },
    };

    $(document).ready(function() {
        var gotoSurveyBtn = $("#goto-survey-btn");
        var nextBtn = $("<button>></button>").attr('id', 'next-btn').prop("disabled", true);
        var prevBtn = $("<button><</button>").attr('id', 'previous-btn').prop("disabled", true);
        var saveBtn = $("<button>Save and Quit</button>").attr('id', 'save-btn').prop("disabled", false);
        var startBtn = $("<button>Start</button>").attr('id', 'start-btn');
        var radioBtn;
        var textInput;

        gotoSurveyBtn.on('click', gotoSurveyBtnClick);
        startBtn.on('click', startSurvey);
        prevBtn.on('click', prevBtnClick);
        nextBtn.on('click', nextBtnClick);
        saveBtn.on('click', saveBtnClick);

        function gotoSurveyBtnClick(e) {
            $("#content").html("Choose your department");
            gotoSurveyBtn.remove();
            // for (i = 0; i < DEPARTMENTS.length; i++) {
            var keys = Object.keys(DEPARTMENTS);
            for (i = 0; i < keys.length; i++) {
                radioBtn = $('<label class="label--radio">\
                <input type="radio" name="rbtnCount" class="radio" value="' + keys[i] + '" >' + DEPARTMENTS[keys[i]] + '</input></label>').attr('id', 'dept' + i);
                radioBtn.appendTo('#content');
                radioBtn.on('change', function(e) {
                    startBtn.prop("disabled", !$("input:checked").val());
                });
            }

            startBtn.prop("disabled", true);
            startBtn.appendTo('body');
        }

        function startSurvey(e) {
            var selected = $("input:checked").val();
            if (!selected) return;

            $("input").remove(".department");
            startBtn.remove();

            appState.selectedDepartment = selected;

            var startAt = whatsNext(appState.selectedDepartment, appState.currQst, "");
            if (startAt > 0 ) {
                appState.stepTracking.push(startAt);
                doRenderQuestion(startAt);    
            } else {
                alert("Out of reach");
            }
            
            prevBtn.appendTo('body');
            saveBtn.appendTo('body');
            nextBtn.appendTo('body');
        }

        function saveBtnClick(e) {
          console.log("save btn clicked");
            $.ajax({
                    method: "POST",
                    contentType: "application/json",
                    url: API_BASE + "/save",
                    data: JSON.stringify({
                        session_id: appState.sessionId,
                        history: appState.history
                    })
                })
                .done(function(msg) {
                    appState.sessionId = msg["session_id"];
                    newUrl=API_BASE + "/s/" + appState.sessionId;
                    var myNode = document.getElementById("body");
                    myNode.innerHTML = '<h1 class="final-msg">We have got your response! </h1><h2 class="final-msg">You can change your response using this link:</h2> <h3 class="final-msg"><a href="'+newUrl+'">'+newUrl+'</a></h3> <h3 class="final-msg">Give this link to other people in your company!</h3>';
                    
                    //alert("new url:" + newUrl );
                    // notiAfterSave("");
                });
        }

        function nextBtnClick(e) {
            var answer = "";
            if ($("input[name=choice]").is(':radio')) {
                answer = $("input[name=choice]:checked").val();
            } else if ($("input[name=choice]").is('input:text')) {
                answer = $("input[name=choice]").text();
            }
            // // store in history array
            // updateHistory(answer);

            // move to next question
            // var nextQstInd = whatsNext(appState.currQst, answer);
            var nextQstInd = whatsNext(appState.selectedDepartment, appState.currQst, answer);

            if (nextQstInd > 0 ) {
                appState.stepTracking.push(nextQstInd);
                doRenderQuestion(nextQstInd);

                prevBtn.prop("disabled", false);
            } else {
                alert("Out of reach");
            }

        }

        function prevBtnClick(e) {
            appState.stepTracking.pop();
            var prevQst = appState.stepTracking[appState.stepTracking.length - 1];
            if (prevQst) doRenderQuestion(prevQst);
            // No more coming back
            if (appState.stepTracking.length == 1) prevBtn.prop("disabled", true);
        }

        function doRenderQuestion(ind) {
            appState.currQst = ind;
            nextBtn.prop("disabled", !appState.history[ind]);

            var question = QUESTION_MAP[ind];
            if (question.qType == QUESTION_TYPE.NO_CHOICE) {
                doRenderQuestion(ind + 1);
                return;
            }
            var choices = question.a;
            var qstContent = "Question " + ind + " - " + question.q;
            if (qstContent.includes("\n")) {
                $("#content").html($('<pre class="formated-text">' + qstContent + '</pre>'));
            } else {
                $("#content").html(qstContent);
            }

            switch (question.qType) {
                case QUESTION_TYPE.MIXED:
                    var mixedQuestionMap = { 11: [2], 15: [0], 42: [0, 1], 43: [0, 1], 70: [0], 72: [0], 77: [2] };
                    for (i = 0; i < choices.length; i++) {
                        radioBtn = $('<label class="label--radio">\
                        <input type="radio" name="choice" class="radio" value="' + choices[i] +
                            '" id="' + i + '" >' + choices[i] + '</input></label>');

                        radioBtn.appendTo('#content');
                        radioBtn.on('change', function(e) {
                            if (mixedQuestionMap[ind].includes(parseInt(e.target.id)) && e.target.checked) {
                                $('<input type="text" name="subAns" id="subAns" />').insertAfter($(e.target).parent());
                                $("#subAns").on('change', function(e) {
                                    updateHistory(e.target.value);
                                });
                            } else {
                                $("#subAns").remove();
                            }
                            updateHistory(e.target.value);
                            nextBtn.prop("disabled", false);
                        });


                    }

                    if (appState.history[ind]) {
                        var $input = $('input[name=choice][value="' + appState.history[ind][0] + '"]');
                        $input.prop("checked", true);

                        if (mixedQuestionMap[ind].includes(parseInt($input.prop("id")))) {
                            $('<input type="text" placeholder="Enter your answer here" name="subAns" id="subAns" />').insertAfter($input.parent());
                            $("#subAns").val(appState.history[ind][1]);
                        }
                    }

                    break;

                case QUESTION_TYPE.TEXT:
                    textInput = $('<input type="text" name="answer" id="answer" />');
                    textInput.appendTo('#content');
                    textInput.on('change keyup', function(e) {
                        updateHistory(e.target.value);
                        nextBtn.prop("disabled", false);
                    });

                    if (appState.history[ind]) textInput.val(appState.history[ind][0]);

                    break;

                case QUESTION_TYPE.MULTI_CHOICE:
                    for (i = 0; i < choices.length; i++) {
                        var checkbox = $('<label class="label--checkbox">\
                        <input type="checkbox" name="choices[]" class="checkbox" value="' + choices[i] + '" >' + choices[i] + '</input>\
                        </label>');

                        checkbox.appendTo('#content');
                        checkbox.on('change', function(e) {
                            var values = $('input[type=checkbox]:checked').map(function() { return this.value; }).get();
                            updateHistory(values);
                            nextBtn.prop("disabled", false);
                        });
                    }

                    // Load data from history
                    if (appState.history[ind]) {
                        appState.history[ind].forEach(function(val) {
                            $('input[type=checkbox][value="' + val + '"]').prop("checked", true);
                        });
                    }

                    break;

                case QUESTION_TYPE.SINGLE_CHOICE:
                    for (i = 0; i < choices.length; i++) {
                        radioBtn = $('<label class="label--radio"><input type="radio" name="choice" class="radio" value="' + choices[i] + '" >' + choices[i] + '</input></label>').attr('id', ind + "-" + i);
                        radioBtn.appendTo('#content');
                        radioBtn.find("input").on('change', function(e) {
                            updateHistory(e.target.value);
                            nextBtn.prop("disabled", false);
                        });
                    }

                    // Load data from history
                    if (appState.history[ind]) $('input[name=choice][value="' + appState.history[ind][0] + '"]').prop("checked", true);

                    break;
            }

        }

        function updateHistory(value) {
            appState.history[appState.currQst] = appState.history[appState.currQst] || [];
            switch (QUESTION_MAP[appState.currQst].qType) {
                case QUESTION_TYPE.MULTI_CHOICE:
                    appState.history[appState.currQst] = value;
                    break;
                case QUESTION_TYPE.MIXED:
                    var selectedVal = $('input[type="radio"]:checked').val();
                    var textVal = $("#subAns").val();
                    appState.history[appState.currQst] = [selectedVal, textVal];
                    break;
                default:
                    appState.history[appState.currQst] = [value];
                    break;
            }
        }

        function whatsNext(department, current, answer) {
            if (department == "ORG" && current >= 0 && current < 11) {
            if (current == "4" && answer == QUESTION_MAP[4].a[0]) {
                return 5;
            } else if ((current == "4" && answer == QUESTION_MAP[4].a[1]) || current == '10') {
                return -1;
            } else {
                return current + 1;
            }
        } else if (department == 'ITS' && ((current > 10 && current < 44) || current == 0)) {
            if (current == 0) {
                return 11;
            } else if (current == "12" && answer == QUESTION_MAP[12].a[1] ) {//Server
                return current += 1;
            } else if (current == "12" && answer == QUESTION_MAP[12].a[0]) { //"Workstation"
                return -1;
            } else if (current == "13" && answer == QUESTION_MAP[13].a[1]) { // "Dedicated"
                return 14;
            } else if (current == "13" && answer == QUESTION_MAP[13].a[0]/*"Basic"*/) {
                return 31;
            } else if (current == "39" && answer == QUESTION_MAP[39].a[2]) { //Yes
                return 40;
            } else if (current == "39" && (answer == QUESTION_MAP[39].a[0] || QUESTION_MAP[39].a[1] )) {
                return 42;
            } else if (current == "43") {
                return -1;
            } else {
                next = current += 1;
                return next;
            }
        } else if (department == 'GIT' && ((current > 43 && current < 50) || current == 0)) {
            if (current == 0) {
                return 44;
            }
            else if (current == "49") {
                return -1;
            } else {
                next = current += 1;
                return next;
            }
        } else if (department == 'ITW' && ((current > 49 && current < 70) || current == 0)) {
            if (current == 0) {
                return 50;
            }
            else if (current == "62" && answer == QUESTION_MAP[62].a[0] ) {//"Yes"
                return 63;
            } else if ((current == "62" && answer == QUESTION_MAP[62].a[1]) || (current == "69")) {
                return -1;
            } else {
                next = current += 1;
                return next;
            }
        } else if (department == 'ENERGY' && ((current > 69 && current < 74) || current == 0)) {
            if (current == 0) {
                return 70;
            }
            else if (current == "73") {
                return -1;
            } else {
                next = current += 1;
                return next;
            }
        } else if (department == 'PRINTING' && ((current > 73 && current < 89) || current == 0)) {
            if (current == 0) {
                return 74;
            }
            else if (current == "88") {
                return -1;
            } else {
                next = current += 1;
                return next;
            }
        } else {
            return -1;
        }

        }

        function notiAfterSave() {
            alert("show after save message with session id");
        }

        function notiEndOfSection() {
            alert("show after the department questions finishes");
        }

        function notiFinalizeSurvey() {
            alert("show finalize message");
        }

    });

    </script>
</head>

<body id="body">
    <div id="content">This is introduction sentence for the survey</div>
    <button id="goto-survey-btn">Go to survey</button>
</body>

</html>
